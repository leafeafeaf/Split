(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[836],{91931:function(e,s,t){Promise.resolve().then(t.bind(t,75643))},75643:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var l=t(57437),r=t(2265),a=t(99376),n=t(84028),c=t(65452),i=t(40133),o=t(9074),d=t(46444),x=t(29948),m=t(24424),h=t(60431),u=t(14438);function p(){let e=(0,a.useRouter)(),s=(0,a.useSearchParams)(),t=(0,x.T)(),{frames:p}=(0,x.C)(e=>e.frame),{isLoading:b,error:g,bowlingScore:f}=(0,x.C)(e=>e.game),[j,S]=(0,r.useState)(!1),[N,v]=(0,r.useState)(),[w,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!w){y(!0);let l=sessionStorage.getItem("frameData");if(l)try{let e=JSON.parse(l);Array.isArray(e)&&10===e.length&&t((0,h.wR)(e))}catch(e){console.error("Failed to parse saved frames:",e)}let r=s.get("score");if(r&&t((0,m.cE)(parseInt(r,10))),!l||10!==p.length){u.Am.error("No complete frame data available"),e.push("/check/measure");return}if(!r){e.push("/check/measure");return}}},[w,t,s,p.length,e]),(0,r.useEffect)(()=>{10===p.length&&sessionStorage.setItem("frameData",JSON.stringify(p))},[p]);let F=10===p.length?{poseScore:p.reduce((e,s)=>e+s.poseScore,0)/p.length,elbowAngleScore:p.reduce((e,s)=>e+s.elbowAngleScore,0)/p.length,armStabilityScore:p.reduce((e,s)=>e+s.armStabilityScore,0)/p.length,speed:p.reduce((e,s)=>e+s.speed,0)/p.length}:null,k=async()=>{if(F&&null!==f)try{console.log("요청 데이터:",{데이터:{frames:p,bowlingScore:f},프레임수:p.length,볼링점수:f}),console.log("게임 통계:",{각도:F.elbowAngleScore,안정성:F.armStabilityScore,속도:F.speed,자세점수:F.poseScore}),await t((0,m.Nv)({frames:p,bowlingScore:f})).unwrap(),t((0,h.IW)()),t((0,m.sP)()),sessionStorage.removeItem("hasShownScoreModal"),sessionStorage.removeItem("bowlingScore"),sessionStorage.removeItem("frameData"),"complete"===N?e.push("/home"):"next"===N&&e.push("/check")}catch(e){var s,l;console.error("API 요청 실패:",{에러:e,상태:null===(s=e.response)||void 0===s?void 0:s.status,메시지:null===(l=e.response)||void 0===l?void 0:l.data}),u.Am.error(e.toString())}finally{S(!1)}};return w&&F?(0,l.jsxs)("div",{className:"min-h-screen bg-[#161622] p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,l.jsx)(n.Z,{}),(0,l.jsx)(c.Z,{})]}),(0,l.jsxs)("div",{className:"max-w-md mx-auto space-y-8",children:[(0,l.jsx)(i.x,{data:{angle:F.elbowAngleScore,stability:F.armStabilityScore,speed:F.speed}}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h2",{className:"text-2xl text-white text-center font-medium",children:"Statistics"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-[#0066FF] text-xl",children:"Angle"}),(0,l.jsx)("p",{className:"text-white text-2xl tabular-nums",children:F.elbowAngleScore.toFixed(2)})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-[#0066FF] text-xl",children:"Stability"}),(0,l.jsx)("p",{className:"text-white text-2xl tabular-nums",children:F.armStabilityScore.toFixed(2)})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-[#0066FF] text-xl",children:"Speed"}),(0,l.jsx)("p",{className:"text-white text-2xl tabular-nums",children:F.speed.toFixed(2)})]})]})]}),(0,l.jsx)("div",{className:"bg-[#1E1E2D] rounded-lg p-4",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-[#9CB1D1] text-xl",children:"Game Score"}),(0,l.jsx)("p",{className:"text-white text-2xl tabular-nums",children:F.poseScore.toFixed(2)})]})}),null!==f&&(0,l.jsx)("div",{className:"bg-[#1E1E2D] rounded-lg p-4",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-[#ECE929] text-xl",children:"Bowling Score"}),(0,l.jsx)("p",{className:"text-white text-2xl",children:f})]})}),(0,l.jsxs)("div",{className:"space-y-4 pt-8",children:[(0,l.jsx)(o.D,{onClick:()=>{v("complete"),S(!0)},className:"w-full py-4",disabled:b||null===f,children:b?"Uploading...":"측정 완료"}),(0,l.jsx)(o.D,{onClick:()=>{e.push("/check/measure")},className:"w-full py-4",disabled:b,children:"돌아가기"}),(0,l.jsx)(o.D,{onClick:()=>{v("next"),S(!0)},className:"w-full py-4",disabled:b||null===f,children:"다음 경기 측정"})]})]}),(0,l.jsx)(d.A,{isOpen:j,onClose:()=>S(!1),onConfirm:k})]}):(0,l.jsx)("div",{className:"min-h-screen bg-[#161622] flex items-center justify-center",children:(0,l.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-[#0066FF] border-r-transparent"})})}function b(){return(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)("div",{className:"min-h-screen bg-[#161622] flex items-center justify-center",children:(0,l.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-[#0066FF] border-r-transparent"})}),children:(0,l.jsx)(p,{})})}}},function(e){e.O(0,[443,303,166,514,575,719,358,116,969,971,117,744],function(){return e(e.s=91931)}),_N_E=e.O()}]);